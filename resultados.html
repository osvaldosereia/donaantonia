<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>direito.love ‚Äî Resultados</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main>

    <!-- TOP BAR (n√£o fixa) -->
    <header>
      <img src="icons/logo-mini.png" alt="direito.love" class="mini-logo">

      <div class="search-wrap" role="search" aria-label="Buscar no Vade Mecum">
        <input id="campoBusca" type="search" placeholder="Pesquisar artigo, lei, s√∫mula ou termo‚Ä¶" />
        <button id="btnBuscar" aria-label="Buscar">üîç</button>
      </div>
    </header>

    <!-- BOX 1: RESULTADOS (por arquivo) -->
    <section class="box" id="box-resultados">
      <div class="title-row">
        <h2>Resultados globais</h2>

        <!-- Setas navegam entre os resultados do arquivo ativo -->
        <div class="nav-arrows">
          <button class="icon-btn" id="navResPrev" title="Anterior">‚¨Ü</button>
          <button class="icon-btn" id="navResNext" title="Pr√≥ximo">‚¨á</button>
        </div>
      </div>

      <!-- Lista de resultados (cards) -->
      <div id="resultados"></div>

      <div class="hr"></div>

      <!-- Chips somente dos ARQUIVOS COM RESULTADO -->
      <div class="chips" id="chipsArquivos" aria-label="Arquivos com resultados">
        <!-- Ex.: <button class="chip active" data-arquivo="civil">CIVIL</button> -->
      </div>
    </section>

    <!-- BOX 2: SELECIONADOS (uma linha por item) -->
    <section class="box" id="box-selecionados">
      <div class="title-row">
        <h2>Selecionados</h2>

        <div style="display:flex; gap:8px; align-items:center;">
          <button id="limpar-tudo" title="Remover todos">LIMPAR TUDO</button>
          <!-- Setas navegam pelos itens selecionados -->
          <div class="nav-arrows">
            <button class="icon-btn" id="navSelPrev" title="Anterior">‚¨Ü</button>
            <button class="icon-btn" id="navSelNext" title="Pr√≥ximo">‚¨á</button>
          </div>
        </div>
      </div>

      <div id="selecionados">
        <!-- Estrutura de item:
          <div class="card">
            <div class="info">
              <div class="titulo">C√≥digo Penal</div>
              <div class="resumo">Art. 186 - ‚Ä¶</div>
            </div>
            <span class="badge-selected">SELECIONADO</span>
          </div>
        -->
      </div>

      <!-- Salvar lista: abre modal para NOVA lista; se j√° houver uma ativa, o app.js salva sem abrir -->
      <button id="salvar-lista">SALVAR LISTA</button>
    </section>

    <!-- MODAL: LISTAS SALVAS (abrir/selecionar/overwrite) -->
    <div id="modalListas" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalListasTitulo">
      <div class="modal-content">
        <h3 id="modalListasTitulo">Listas salvas</h3>
        <ul id="listasSalvas"></ul>
        <div class="modal-actions">
          <button class="btn-pill" onclick="fecharModalListas()">Fechar</button>
          <button class="btn-pill" onclick="excluirTodasListas()" style="color:#a33;">Excluir todas</button>
        </div>
      </div>
    </div>

    <!-- MODAL: NOVA LISTA (solicita nome) -->
    <div id="modalNovaLista" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalNovaListaTitulo">
      <div class="modal-content">
        <h3 id="modalNovaListaTitulo">Nome da nova lista</h3>
        <input id="nomeNovaLista" class="input-pill" type="text" placeholder="Ex.: Tutelas CPC ‚Äî prova" />
        <div class="modal-actions">
          <button class="btn-pill" id="btnCancelarNovaLista">Cancelar</button>
          <button class="btn-pill" id="btnConfirmarNovaLista">Salvar</button>
        </div>
      </div>
    </div>

    <!-- RODAP√â (n√£o fixo) -->
    <footer>
      <button class="btn-footer" id="btnAbrirListas">ABRIR LISTAS</button>
      <button class="btn-footer" id="btnNovaLista">NOVA LISTA</button>
    </footer>
  </main>

  <script src="app.js"></script>
  <script>
    /* Liga√ß√µes m√≠nimas na carga */
    document.addEventListener('DOMContentLoaded', () => {
      // Preenche busca com termo da URL (se houver)
      if (typeof getParametroBusca === 'function') {
        const t = getParametroBusca();
        const i = document.getElementById('campoBusca');
        if (i) i.value = t;
      }

      // Buscar (clique/Enter)
      const btnBuscar = document.getElementById('btnBuscar');
      const campoBusca = document.getElementById('campoBusca');
      if (btnBuscar) btnBuscar.addEventListener('click', () => typeof novaBusca === 'function' && novaBusca());
      if (campoBusca) campoBusca.addEventListener('keydown', e => (e.key === 'Enter') && typeof novaBusca === 'function' && novaBusca());

      // Render inicial
      if (typeof renderizarResultados === 'function') {
        const termo = (typeof getParametroBusca === 'function') ? getParametroBusca() : '';
        renderizarResultados(termo);
      }
      if (typeof renderizarSelecionados === 'function') renderizarSelecionados();

      // Footer
      const btnAbrirListas = document.getElementById('btnAbrirListas');
      if (btnAbrirListas) btnAbrirListas.addEventListener('click', () => typeof abrirModalListas === 'function' && abrirModalListas());

      const btnNovaLista = document.getElementById('btnNovaLista');
      if (btnNovaLista) btnNovaLista.addEventListener('click', () => {
        // ‚ÄúNova lista‚Äù: limpa pesquisa+selecionados e pede nome
        if (typeof iniciarNovaLista === 'function') iniciarNovaLista();
      });

      // Selecionados: Limpar
      const btnLimpar = document.getElementById('limpar-tudo');
      if (btnLimpar) btnLimpar.addEventListener('click', () => typeof limparSelecionados === 'function' && limparSelecionados());

      // Salvar lista (abre modal se n√£o existir lista ativa)
      const btnSalvar = document.getElementById('salvar-lista');
      if (btnSalvar) btnSalvar.addEventListener('click', () => typeof salvarListaFlow === 'function' && salvarListaFlow());

      // Modal ‚ÄúNova Lista‚Äù
      const btnCancelarNovaLista = document.getElementById('btnCancelarNovaLista');
      const btnConfirmarNovaLista = document.getElementById('btnConfirmarNovaLista');
      if (btnCancelarNovaLista) btnCancelarNovaLista.addEventListener('click', () => {
        document.getElementById('modalNovaLista')?.classList.add('hidden');
      });
      if (btnConfirmarNovaLista) btnConfirmarNovaLista.addEventListener('click', () => {
        if (typeof confirmarCriacaoNovaLista === 'function') confirmarCriacaoNovaLista();
      });

      // Setas de navega√ß√£o (resultados e selecionados)
      const navResPrev = document.getElementById('navResPrev');
      const navResNext = document.getElementById('navResNext');
      const navSelPrev = document.getElementById('navSelPrev');
      const navSelNext = document.getElementById('navSelNext');

      if (navResPrev) navResPrev.addEventListener('click', () => typeof navegarResultados === 'function' && navegarResultados(-1));
      if (navResNext) navResNext.addEventListener('click', () => typeof navegarResultados === 'function' && navegarResultados(1));
      if (navSelPrev) navSelPrev.addEventListener('click', () => typeof navegarSelecionados === 'function' && navegarSelecionados(-1));
      if (navSelNext) navSelNext.addEventListener('click', () => typeof navegarSelecionados === 'function' && navegarSelecionados(1));
    });
  </script>
</body>
</html>
